/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/Users/antoinechoppin/dev/github/penguinBlockly/public";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./main.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./main.js":
/*!*****************!*\
  !*** ./main.js ***!
  \*****************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var workspace = Blockly.inject('blocklyPanel', {
    toolbox: document.getElementById('toolbox'),
    grid: {
        spacing: 18,
        length: 3,
        colour: '#ccc',
        snap: true
    },
    trashcan: true,
    zoom: {
        controls: true,
        startScale: 1.0,
        maxScale: 3,
        minScale: 0.3,
        scaleSpeed: 1.2
    }
});

var createPseudoContext = function createPseudoContext(interpreter, context) {
    var myContext = interpreter.createObjectProto(interpreter.OBJECT_PROTO);
    var contextFunctions = ['beginPath', 'stroke', 'fill', 'moveTo', 'lineTo', 'fillRect', 'strokeRect', 'clearRect', 'arc'];

    var _loop = function _loop() {
        var fn = contextFunctions[i];

        switch (context[fn].length) {// Check arity
            case 0:
                wrapper = function wrapper() {
                    return interpreter.createPrimitive(context[fn].call(context));
                };
                break;
            case 2:
                wrapper = function wrapper(arg0, arg1) {
                    return interpreter.createPrimitive(context[fn].call(context, arg0, arg1));
                };
                break;
            case 4:
                wrapper = function wrapper(arg0, arg1, arg2, arg3) {
                    return interpreter.createPrimitive(context[fn].call(context, arg0, arg1, arg2, arg3));
                };
                break;
            case 5:
                wrapper = function wrapper(arg0, arg1, arg2, arg3, arg4) {
                    return interpreter.createPrimitive(context[fn].call(context, arg0, arg1, arg2, arg3, arg4));
                };
                break;
        }
        interpreter.setProperty(myContext, fn, interpreter.createNativeFunction(wrapper, false), Interpreter.NONENUMERABLE_DESCRIPTOR);
    };

    for (var i = 0; i < contextFunctions.length; i++) {
        var wrapper;

        _loop();
    }
    var contextProperties = ['fillStyle', 'strokeStyle', 'lineWidth'];

    var _loop2 = function _loop2() {
        var prop = contextProperties[i];

        getProp = function getProp() {
            return interpreter.createPrimitive(context[prop]);
        };

        setProp = function setProp(value) {
            context[prop] = value;
        };

        descriptor = {
            configurable: true,
            enumerable: true,
            get: interpreter.createNativeFunction(getProp, false),
            set: interpreter.createNativeFunction(setProp, false)
        };

        interpreter.setProperty(myContext, prop, Interpreter.VALUE_IN_DESCRIPTOR, descriptor);
    };

    for (var i = 0; i < contextProperties.length; i++) {
        var getProp;
        var setProp;
        var descriptor;

        _loop2();
    }
    return myContext;
};

var createPseudoCanvas = function createPseudoCanvas(interpreter, canvas) {
    var myCanvas = interpreter.createObjectProto(interpreter.OBJECT_PROTO);

    function getContextWrapper(type) {
        if (type !== '2d') {
            throw IllegalArgument('Only 2d context is supported (got ' + type + ')');
        }
        var nativeContext = interpreter.createPrimitive(canvas.getContext(type));
        return createPseudoContext(interpreter, nativeContext);
    }
    interpreter.setProperty(myCanvas, 'getContext', interpreter.createNativeFunction(getContextWrapper, false), Interpreter.NONENUMERABLE_DESCRIPTOR);
    return myCanvas;
};

var initDocument = function initDocument(interpreter, scope) {
    var myDocument = interpreter.createObjectProto(interpreter.OBJECT_PROTO);
    interpreter.setProperty(scope, 'document', myDocument);

    function getElementWrapper(id) {
        var nativeElement = interpreter.createPrimitive(document.getElementById(id));
        if (nativeElement.tagName !== 'CANVAS') {
            throw TypeError('Only Canvas DOM element is supported (got ' + (typeof nativeElement === 'undefined' ? 'undefined' : _typeof(nativeElement)) + ')');
        }
        return createPseudoCanvas(interpreter, nativeElement);
    }
    interpreter.setProperty(myDocument, 'getElementById', interpreter.createNativeFunction(getElementWrapper, false), Interpreter.NONENUMERABLE_DESCRIPTOR);
};

var initConsole = function initConsole(interpreter, scope) {
    var myConsole = interpreter.createObjectProto(interpreter.OBJECT_PROTO);
    interpreter.setProperty(scope, 'console', myConsole);
    var consoleFunctions = ['log'];
    for (var i = 0; i < consoleFunctions.length; i++) {
        interpreter.setProperty(myConsole, consoleFunctions[i], interpreter.createNativeFunction(console[consoleFunctions[i]], false), Interpreter.NONENUMERABLE_DESCRIPTOR);
    }
};

var initWindow = function initWindow(interpreter, scope) {
    function requestAnimationFrameWrapper(animationCallback, callback) {
        function callbackWrapper() {
            var stack = interpreter.stateStack;
            var currentState = stack.pop();
            var fnName = currentState.node.arguments[0].name;
            console.log('Looking for ' + fnName + ' in call stack.');
            var found = false;
            var i = stack.length - 1;
            for (; i > 0; i--) {
                var s = stack[i];
                if (s.node.type === 'CallExpression' && s.node.callee.name === fnName) {
                    found = true;
                    break;
                }
            }
            if (!found) {
                throw EvalError('Could not find ' + fnName + ' in call stack.');
            }
            for (var j = stack.length - 1; j > i; j--) {
                stack.pop();
            }
            var state = stack[stack.length - 1];
            state.doneCallee_ = 0;
            state.doneExec_ = false;
            state.doneArgs_ = false;
            console.log(state);
            stack.push(currentState);
            console.log(stack[stack.length - 1]);
            // debugger;
            callback();
        }
        return interpreter.createPrimitive(window.requestAnimationFrame(callbackWrapper));
    }
    interpreter.setProperty(scope, 'requestAnimationFrame', interpreter.createAsyncFunction(requestAnimationFrameWrapper), Interpreter.NONENUMERABLE_DESCRIPTOR);
};

var initHighlight = function initHighlight(interpreter, scope) {
    var highlightBlockWrapper = function highlightBlockWrapper(id, callback) {
        var ret = workspace.highlightBlock(id);
        setTimeout(callback, 1000);
        return ret;
    };
    interpreter.setProperty(scope, 'highlightBlock', interpreter.createAsyncFunction(highlightBlockWrapper));

    var highlightLineWrapper = function highlightLineWrapper(lineNum, callback) {
        if (-1 === lineNum) {
            editor.selection.clearSelection();
        } else {
            editor.selection.moveCursorToPosition({ row: lineNum, column: 0 });
            editor.selection.selectLine();
            setTimeout(callback, 1000);
        }
        return true;
    };
    interpreter.setProperty(scope, 'highlightLine', interpreter.createAsyncFunction(highlightLineWrapper));

    function alertWrapper(text) {
        var msg = text ? text.toString() : '';
        return interpreter.createPrimitive(window.alert(msg));
    }
    interpreter.setProperty(scope, 'alert', interpreter.createNativeFunction(alertWrapper));
};

function createInterpreter(code) {
    function initialize(interpreter, scope) {
        initDocument(interpreter, scope);
        initConsole(interpreter, scope);
        initWindow(interpreter, scope);
        initHighlight(interpreter, scope);
    }
    return new Interpreter(code, initialize);
}

function generateCode(workspace) {
    var highlightBlocks = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

    if (highlightBlocks) {
        Blockly.JavaScript.STATEMENT_PREFIX = 'highlightBlock(%1);\n';
    } else {
        Blockly.JavaScript.STATEMENT_PREFIX = '';
    }
    var code = Blockly.JavaScript.workspaceToCode(workspace);
    if (highlightBlocks) {
        code += "highlightBlock(null);\n";
    }
    console.log(code);
    return code;
}

var running = false;
var mustStop = false;
setRunning(false);

function annotateCodeForStopping(code) {
    var lines = code.split("\n");
    var annotatedLines = [];
    lines.forEach(function (l, i) {
        annotatedLines[2 * i] = l;
        annotatedLines[2 * i + 1] = 'if (mustStop) { setRunning(false); throw EvalError("Stopped."); }';
    });
    var annotatedCode = annotatedLines.join("\n");
    if (annotatedCode.indexOf('requestAnimationFrame') === -1 && annotatedCode.indexOf('setTimeout') === -1) {
        annotatedCode += '\nsetRunning(false);\n';
    }
    return annotatedCode;
}

function runBlocks() {
    setRunning(true);
    var code = annotateCodeForStopping(generateCode(workspace, false));
    eval(code);
}

function debugBlocks() {
    setRunning(true);
    var code = generateCode(workspace, true);
    var jsInterpreter = createInterpreter(code);
    var runOnce = function runOnce() {
        if (jsInterpreter.run() && !mustStop) {
            setTimeout(runOnce, 1000);
        } else {
            if (mustStop) {
                workspace.highlightBlock(null);
            }
            setRunning(false);
        }
    };
    runOnce();
}

function runCode() {
    setRunning(true);
    var code = annotateCodeForStopping(editor.getSession().getValue());
    eval(code);
}

function annotateCodeForHighlight(code) {
    var lines = code.split("\n");
    var annotatedLines = [];
    lines.forEach(function (l, i) {
        annotatedLines[2 * i] = 'highlightLine(' + i + ');';
        annotatedLines[2 * i + 1] = l;
    });
    return annotatedLines.join("\n") + 'highlightLine(-1);';
}

function debugCode() {
    setRunning(true);
    var code = annotateCodeForHighlight(editor.getSession().getValue());
    console.log(code);
    var jsInterpreter = createInterpreter(code);
    var runOnce = function runOnce() {
        if (jsInterpreter.run() && !mustStop) {
            setTimeout(runOnce, 1000);
        } else {
            if (mustStop) {
                editor.selection.clearSelection();
            }
            setRunning(false);
        }
    };
    runOnce();
}

function isBlocklyVisible() {
    return document.getElementById('blockly').classList.contains('active');
}

function runProgram() {
    if (running) {
        return;
    }
    if (isBlocklyVisible()) {
        runBlocks();
    } else {
        runCode();
    }
}

function debugProgram() {
    if (running) {
        return;
    }
    if (isBlocklyVisible()) {
        debugBlocks();
    } else {
        debugCode();
    }
}

function stopProgram() {
    if (!running) {
        return;
    }
    mustStop = true;
}

function setRunning(value) {
    running = value;
    mustStop = false;
    if (running) {
        $('#runBtn').addClass('disabled');
        $('#debugBtn').addClass('disabled');
        $('#sampleBtn').addClass('disabled');
        $('#saveDropdownLink').addClass('disabled');
        $('#loadDropdownLink').addClass('disabled');
        $('#stopBtn').removeClass('disabled');
        $('.nav-link').addClass('disabled');
    } else {
        $('#runBtn').removeClass('disabled');
        $('#debugBtn').removeClass('disabled');
        $('#sampleBtn').removeClass('disabled');
        $('#saveDropdownLink').removeClass('disabled');
        $('#loadDropdownLink').removeClass('disabled');
        $('#stopBtn').addClass('disabled');
        $('.nav-link').removeClass('disabled');
    }
}

function sampleBlocks_() {
    var blocks = function () {
        /*
        <xml xmlns="http://www.w3.org/1999/xhtml">
            <variables></variables>
            <block type="penguin_getcontext2d" id="{?{S(h!qLu~9+8|sqqUf" x="28" y="23"><next>
            <block type="penguin_clearrect" id="`iP._71rw=#z+j{ewM11"><value name="x"><block type="math_number" id="h.f[IdL#]4=r,|ZrO[dn"><field name="NUM">0</field></block></value><value name="y"><block type="math_number" id="h=!koJS~M|`G[1c=wDH9"><field name="NUM">0</field></block></value><value name="width"><block type="math_number" id="2_(`GESem?3N@~J%i+y]"><field name="NUM">800</field></block></value><value name="height"><block type="math_number" id="nl+Ne2/Skxdb[Zkw2Dpl"><field name="NUM">600</field></block></value><next>
            <block type="penguin_fillstyle" id="%l(|m.irwrl#}iDdr6+1"><field name="color">lightblue</field><next>
            <block type="penguin_fillrect" id="o#fO{oo0DJ6D79uj{(;d"><value name="x"><block type="math_number" id="U+!J3HC245a@jYg!e)ij"><field name="NUM">0</field></block></value><value name="y"><block type="math_number" id="fL3PZP,9B6b5$nRFW7G)"><field name="NUM">0</field></block></value><value name="width"><block type="math_number" id="L8?d{E/.34mT,yj8@-+4"><field name="NUM">800</field></block></value><value name="height"><block type="math_number" id="0[UQDZ$:q]|5X]$ULl/f"><field name="NUM">600</field></block></value><next>
            <block type="penguin_fillstyle" id="W]_oflp$K{1MymA.CK?."><field name="color">green</field><next>
            <block type="penguin_fillrect" id="og2zth*[L.S?L]$b8Bj_"><value name="x"><block type="math_number" id="H6Wao:,_|uTlsJK(Pid)"><field name="NUM">0</field></block></value><value name="y"><block type="math_number" id="8^F#x]Hi|a2dU+#H:QW:"><field name="NUM">500</field></block></value><value name="width"><block type="math_number" id="FLi8FP3%;U.8O)~.O[?a"><field name="NUM">800</field></block></value><value name="height"><block type="math_number" id="V{E80CiHYlXj$;/}W~%d"><field name="NUM">100</field></block></value><next>
            <block type="penguin_strokestyle" id="o;q*FMlnW]Ok[qX@[vd="><field name="color">brown</field><next>
            <block type="penguin_strokepath" id="sXkeG^Y2lrzV-$v_3V]*"><statement name="path_block"><block type="penguin_linewidth" id="C%aaRJ.uM`K3C25mGY4z"><value name="width"><block type="math_number" id="_iw_G}]62Cl~}g]UwnDN"><field name="NUM">10</field></block></value><next>
            <block type="penguin_moveto" id="2;|7quaR99DY%DtQTZF-"><value name="x"><block type="math_number" id="gV5-8T:(?UITI(iOMJS`"><field name="NUM">200</field></block></value><value name="y"><block type="math_number" id="M5|*{y|swytl51jKZQyJ"><field name="NUM">500</field></block></value><next>
            <block type="penguin_lineto" id="XKyx/$a^ulZT7ctbUWfa"><value name="x"><block type="math_number" id="yPSyjG)B5[dLeHSIPoj*"><field name="NUM">200</field></block></value><value name="y"><block type="math_number" id="+-^NyRqtZmiSRU8n+Q@G"><field name="NUM">400</field></block></value></block></next>
            </block></next>
            </block></statement><next>
            <block type="penguin_strokepath" id="E!OR;MRW3VW%Bopk|Y-7"><statement name="path_block"><block type="penguin_linewidth" id="%Rf/5^wyKN[BrP!,sl3S"><value name="width"><block type="math_number" id="NyT^}f%?f$rA4nWd}nh="><field name="NUM">5</field></block></value><next>
            <block type="penguin_moveto" id="WDp4fgD%2,|aw#i~Pb|F"><value name="x"><block type="math_number" id="o@X}I!)TrD:vixi0EOnh"><field name="NUM">200</field></block></value><value name="y"><block type="math_number" id="z`SMT|,YYLE9vDct:vOM"><field name="NUM">400</field></block></value><next>
            <block type="penguin_lineto" id=")U$!-lr(iun7N]P5t;X4"><value name="x"><block type="math_number" id="Jd[Z%?XLoI[1j{?O{W[j"><field name="NUM">150</field></block></value><value name="y"><block type="math_number" id="Qw70J$JwG$R(SA=nn$y$"><field name="NUM">350</field></block></value><next>
            <block type="penguin_moveto" id="o_hp6/ow(R_$Xb-i!8Y%"><value name="x"><block type="math_number" id="bZ#$u^GZJlVw!q.9VfG5"><field name="NUM">200</field></block></value><value name="y"><block type="math_number" id="omPF0?:mUSwU/*V@$Qpc"><field name="NUM">400</field></block></value><next>
            <block type="penguin_lineto" id="jI)y-T3e81yF`WV5apQT"><value name="x"><block type="math_number" id="/6?#:B)}XjYjh=6fOy^b"><field name="NUM">220</field></block></value><value name="y"><block type="math_number" id="o_h?!D|MwR5;I*E^4}P5"><field name="NUM">380</field></block></value></block></next>
            </block></next></block></next></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block>
        </xml>
        */
    }.toString().split("\n").slice(2, -2).join("\n");
    var xml = Blockly.Xml.textToDom(blocks);
    Blockly.Xml.domToWorkspace(xml, workspace);
}

function sampleBlocks() {
    // Program to run animation
    var blocks = function () {
        /*
        <xml xmlns="http://www.w3.org/1999/xhtml">
            <variables><variable type="" id="%hqk*.WtWb6?[?dG^mSb">x</variable><variable type="" id="(Jy!R%Sxw;$!V9|,m)P1">vx</variable></variables>
            <block type="penguin_getcontext2d" id="v7:iaM*S!P{pi~(7tnGA" x="28" y="12"><next>
            <block type="variables_set" id="jA[xJscr[k,?Ct(F[y1O"><field name="VAR" id="%hqk*.WtWb6?[?dG^mSb" variabletype="">x</field><value name="VALUE"><block type="math_number" id="|NQS24{FBA@F+U/att:U"><field name="NUM">100</field></block></value><next>
            <block type="variables_set" id="iRS!=!M{B;U8|PE,NxGP"><field name="VAR" id="(Jy!R%Sxw;$!V9|,m)P1" variabletype="">vx</field><value name="VALUE"><block type="math_number" id="f%Q}eJcE0yMKgZ2c}GW$"><field name="NUM">10</field></block></value><next>
            <block type="penguin_fillstyle" id="%@?C(j[~`3Z||Wj0S8%."><field name="color">red</field><next>
            <block type="penguin_animation" id="d1c:+kzWynQiC|Dp`|IJ"><statement name="animation_block"><block type="penguin_clearrect" id="peE$BTe!WH=WXkwZeO#^"><value name="x"><block type="math_number" id="A|)2;esX~:XlnC4IC-[k"><field name="NUM">0</field></block></value><value name="y"><block type="math_number" id="1O1T$*WVu_5:{|QU(2{;"><field name="NUM">0</field></block></value><value name="width"><block type="math_number" id="+JH85%C++y](e}}z(zm{"><field name="NUM">800</field></block></value><value name="height"><block type="math_number" id="uC1{yK]q]K($lDSbF#Ts"><field name="NUM">600</field></block></value><next>
            <block type="penguin_fillpath" id="od_=U0O+!.YWD_K|H;.O"><statement name="path_block"><block type="penguin_circle" id="Diqx[w#X.v~EbsJy[-Ug"><value name="x"><block type="variables_get" id="(60S`@lr+NG.3R3_Ro:M"><field name="VAR" id="%hqk*.WtWb6?[?dG^mSb" variabletype="">x</field></block></value><value name="y"><block type="math_number" id=";qmzq]9D7*o+s2Bs45;z"><field name="NUM">400</field></block></value><value name="radius"><block type="math_number" id="tQS(?AgIQO`^.;pM2aVY"><field name="NUM">50</field></block></value><next>
            <block type="math_change" id="VZR2+l%|Njp7d64rUTs^"><field name="VAR" id="%hqk*.WtWb6?[?dG^mSb" variabletype="">x</field><value name="DELTA"><shadow type="math_number" id="Xld|-+;LQIy:@}HE65O3"><field name="NUM">1</field></shadow><block type="variables_get" id="nnx|A_XB6`/5:Ue3Og2I"><field name="VAR" id="(Jy!R%Sxw;$!V9|,m)P1" variabletype="">vx</field></block></value><next>
            <block type="controls_if" id="fe[L;Lz14,V5!|Z_RK4/"><value name="IF0"><block type="logic_operation" id=")#vt|=]*rwi}d1|XIf^B"><field name="OP">OR</field><value name="A"><block type="logic_compare" id="{nAEp|GvanqEDcOBT4:p"><field name="OP">LT</field><value name="A"><block type="variables_get" id="KnQwlQq!2o8qWW.3emEo"><field name="VAR" id="%hqk*.WtWb6?[?dG^mSb" variabletype="">x</field></block></value><value name="B"><block type="math_number" id="}Lw4tRMa}mx7~ZOY4m:?"><field name="NUM">100</field></block></value></block></value><value name="B"><block type="logic_compare" id="1vkj80YG8^ND.?zR9V.I"><field name="OP">GT</field><value name="A"><block type="variables_get" id="4VOG/gVeT[]PO65c9m;]"><field name="VAR" id="%hqk*.WtWb6?[?dG^mSb" variabletype="">x</field></block></value><value name="B"><block type="math_number" id="~Zx3;R)PF)m9%Fv]EzLe"><field name="NUM">700</field></block></value></block></value></block></value><statement name="DO0"><block type="variables_set" id="tOtiDhs1!?L_p_xWjR.}"><field name="VAR" id="(Jy!R%Sxw;$!V9|,m)P1" variabletype="">vx</field><value name="VALUE"><block type="math_arithmetic" id=".{P,bei{,@~,nKa(}v5i"><field name="OP">MINUS</field><value name="A"><block type="math_number" id="_ak[qb~xP?^^/EP+^%p7"><field name="NUM">0</field></block></value><value name="B"><block type="variables_get" id="7zM]S7j]*]H;N{Q0@q}n"><field name="VAR" id="(Jy!R%Sxw;$!V9|,m)P1" variabletype="">vx</field></block></value></block></value></block></statement></block></next></block></next></block></statement></block></next></block></statement></block></next></block></next></block></next></block></next></block></xml>
        */
    }.toString().split("\n").slice(2, -2).join("\n");
    var xml = Blockly.Xml.textToDom(blocks);
    Blockly.Xml.domToWorkspace(xml, workspace);
}

function sampleCode() {
    var code = function () {
        /*
        var game = document.getElementById("game");
        var ctx = game.getContext("2d");
        ctx.clearRect(0,0,800,600);
        ctx.fillStyle = "lightblue";
        ctx.fillRect(0,0,800,600);
        ctx.fillStyle = "green";
        ctx.fillRect(0,500,800,100);
        ctx.strokeStyle = "brown";
        ctx.beginPath();
          ctx.lineWidth = 10;
          ctx.moveTo(200,500);
          ctx.lineTo(200,400);
        ctx.stroke();
        ctx.beginPath();
          ctx.lineWidth = 5;
          ctx.moveTo(200,400);
          ctx.lineTo(150,350);
          ctx.moveTo(200,400);
          ctx.lineTo(220,380);
        ctx.stroke();
        */
    }.toString().split("\n").slice(2, -2).join("\n");
    editor.getSession().setValue(code);
}

function sampleProgram() {
    if (running) {
        return;
    }
    if (isBlocklyVisible()) {
        sampleBlocks();
    } else {
        sampleCode();
    }
}

function saveBlocks() {
    var xml = Blockly.Xml.workspaceToDom(workspace);
    var xml_text = Blockly.Xml.domToText(xml);
    var filename = document.getElementById('saveFilename').value;
    var link = document.getElementById('saveBtn');
    link.download = filename;
    link.href = 'data:text/xml;charset=utf-8,' + encodeURIComponent(xml_text);
}

function saveCode() {
    var code = editor.getSession().getValue();
    var filename = document.getElementById('saveFilename').value;
    var link = document.getElementById('saveBtn');
    link.download = filename;
    link.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(code);
}

function saveProgram(e) {
    if (isBlocklyVisible()) {
        saveBlocks();
    } else {
        saveCode();
    }
    $('#saveDropdownLink').dropdown('toggle');
}

function loadBlocks() {
    var fileSelector = document.getElementById('loadFilename');
    var loadFilename = fileSelector.files[0];
    var reader = new FileReader();
    reader.readAsText(loadFilename);
    reader.onload = function (ev) {
        var xml = Blockly.Xml.textToDom(reader.result);
        Blockly.Xml.domToWorkspace(xml, workspace);
    };
    $('#loadDropdownLink').dropdown('toggle');
}

function loadCode() {
    var fileSelector = document.getElementById('loadFilename');
    var loadFilename = fileSelector.files[0];
    var reader = new FileReader();
    reader.readAsText(loadFilename);
    reader.onload = function (ev) {
        editor.getSession().setValue(reader.result);
    };
    $('#loadDropdownLink').dropdown('toggle');
}

function loadProgram() {
    if (isBlocklyVisible()) {
        loadBlocks();
    } else {
        loadCode();
    }
}

document.getElementById('runBtn').addEventListener('click', runProgram, false);
document.getElementById('debugBtn').addEventListener('click', debugProgram, false);
document.getElementById('stopBtn').addEventListener('click', stopProgram, false);
document.getElementById('saveBtn').addEventListener('click', saveProgram, false);
document.getElementById('loadBtn').addEventListener('click', loadProgram, false);
document.getElementById('sampleBtn').addEventListener('click', sampleProgram, false);

// Initialize ACE Javascript editor
var editor = ace.edit("jsCode");
editor.setTheme("ace/theme/monokai");
editor.session.setMode("ace/mode/javascript");
editor.setOptions({
    // fontFamily: "tahoma",
    fontSize: "12pt"
});

$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
    if (e.target.id === 'code-tab') {
        var code = generateCode(workspace, false);
        editor.getSession().setValue(code);

        var xml = Blockly.Xml.workspaceToDom(workspace);
        var xml_text = Blockly.Xml.domToText(xml);
        console.log(xml_text);
    }
});

function resize() {
    console.log("resize");
    var w = window.innerWidth - 850;
    var h = document.getElementById("game").clientHeight;
    var p = document.getElementById("tabNavContent");
    if (p.clientWidth != w) {
        p.setAttribute("style", "width: " + w + "px; height: " + h + "px;");
        // This is a hack to force resize after selecting another
        setTimeout(function () {
            var e = new CustomEvent("resize");
            window.dispatchEvent(e);
        }, 1);
    }
}

resize();

window.onresize = resize;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbWFpbi5qcyJdLCJuYW1lcyI6WyJ3b3Jrc3BhY2UiLCJCbG9ja2x5IiwiaW5qZWN0IiwidG9vbGJveCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJncmlkIiwic3BhY2luZyIsImxlbmd0aCIsImNvbG91ciIsInNuYXAiLCJ0cmFzaGNhbiIsInpvb20iLCJjb250cm9scyIsInN0YXJ0U2NhbGUiLCJtYXhTY2FsZSIsIm1pblNjYWxlIiwic2NhbGVTcGVlZCIsImNyZWF0ZVBzZXVkb0NvbnRleHQiLCJpbnRlcnByZXRlciIsImNvbnRleHQiLCJteUNvbnRleHQiLCJjcmVhdGVPYmplY3RQcm90byIsIk9CSkVDVF9QUk9UTyIsImNvbnRleHRGdW5jdGlvbnMiLCJmbiIsImkiLCJ3cmFwcGVyIiwiY3JlYXRlUHJpbWl0aXZlIiwiY2FsbCIsImFyZzAiLCJhcmcxIiwiYXJnMiIsImFyZzMiLCJhcmc0Iiwic2V0UHJvcGVydHkiLCJjcmVhdGVOYXRpdmVGdW5jdGlvbiIsIkludGVycHJldGVyIiwiTk9ORU5VTUVSQUJMRV9ERVNDUklQVE9SIiwiY29udGV4dFByb3BlcnRpZXMiLCJwcm9wIiwiZ2V0UHJvcCIsInNldFByb3AiLCJ2YWx1ZSIsImRlc2NyaXB0b3IiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwic2V0IiwiVkFMVUVfSU5fREVTQ1JJUFRPUiIsImNyZWF0ZVBzZXVkb0NhbnZhcyIsImNhbnZhcyIsIm15Q2FudmFzIiwiZ2V0Q29udGV4dFdyYXBwZXIiLCJ0eXBlIiwiSWxsZWdhbEFyZ3VtZW50IiwibmF0aXZlQ29udGV4dCIsImdldENvbnRleHQiLCJpbml0RG9jdW1lbnQiLCJzY29wZSIsIm15RG9jdW1lbnQiLCJnZXRFbGVtZW50V3JhcHBlciIsImlkIiwibmF0aXZlRWxlbWVudCIsInRhZ05hbWUiLCJUeXBlRXJyb3IiLCJpbml0Q29uc29sZSIsIm15Q29uc29sZSIsImNvbnNvbGVGdW5jdGlvbnMiLCJjb25zb2xlIiwiaW5pdFdpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZVdyYXBwZXIiLCJhbmltYXRpb25DYWxsYmFjayIsImNhbGxiYWNrIiwiY2FsbGJhY2tXcmFwcGVyIiwic3RhY2siLCJzdGF0ZVN0YWNrIiwiY3VycmVudFN0YXRlIiwicG9wIiwiZm5OYW1lIiwibm9kZSIsImFyZ3VtZW50cyIsIm5hbWUiLCJsb2ciLCJmb3VuZCIsInMiLCJjYWxsZWUiLCJFdmFsRXJyb3IiLCJqIiwic3RhdGUiLCJkb25lQ2FsbGVlXyIsImRvbmVFeGVjXyIsImRvbmVBcmdzXyIsInB1c2giLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjcmVhdGVBc3luY0Z1bmN0aW9uIiwiaW5pdEhpZ2hsaWdodCIsImhpZ2hsaWdodEJsb2NrV3JhcHBlciIsInJldCIsImhpZ2hsaWdodEJsb2NrIiwic2V0VGltZW91dCIsImhpZ2hsaWdodExpbmVXcmFwcGVyIiwibGluZU51bSIsImVkaXRvciIsInNlbGVjdGlvbiIsImNsZWFyU2VsZWN0aW9uIiwibW92ZUN1cnNvclRvUG9zaXRpb24iLCJyb3ciLCJjb2x1bW4iLCJzZWxlY3RMaW5lIiwiYWxlcnRXcmFwcGVyIiwidGV4dCIsIm1zZyIsInRvU3RyaW5nIiwiYWxlcnQiLCJjcmVhdGVJbnRlcnByZXRlciIsImNvZGUiLCJpbml0aWFsaXplIiwiZ2VuZXJhdGVDb2RlIiwiaGlnaGxpZ2h0QmxvY2tzIiwiSmF2YVNjcmlwdCIsIlNUQVRFTUVOVF9QUkVGSVgiLCJ3b3Jrc3BhY2VUb0NvZGUiLCJydW5uaW5nIiwibXVzdFN0b3AiLCJzZXRSdW5uaW5nIiwiYW5ub3RhdGVDb2RlRm9yU3RvcHBpbmciLCJsaW5lcyIsInNwbGl0IiwiYW5ub3RhdGVkTGluZXMiLCJmb3JFYWNoIiwibCIsImFubm90YXRlZENvZGUiLCJqb2luIiwiaW5kZXhPZiIsInJ1bkJsb2NrcyIsImV2YWwiLCJkZWJ1Z0Jsb2NrcyIsImpzSW50ZXJwcmV0ZXIiLCJydW5PbmNlIiwicnVuIiwicnVuQ29kZSIsImdldFNlc3Npb24iLCJnZXRWYWx1ZSIsImFubm90YXRlQ29kZUZvckhpZ2hsaWdodCIsImRlYnVnQ29kZSIsImlzQmxvY2tseVZpc2libGUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJ1blByb2dyYW0iLCJkZWJ1Z1Byb2dyYW0iLCJzdG9wUHJvZ3JhbSIsIiQiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwic2FtcGxlQmxvY2tzXyIsImJsb2NrcyIsInNsaWNlIiwieG1sIiwiWG1sIiwidGV4dFRvRG9tIiwiZG9tVG9Xb3Jrc3BhY2UiLCJzYW1wbGVCbG9ja3MiLCJzYW1wbGVDb2RlIiwic2V0VmFsdWUiLCJzYW1wbGVQcm9ncmFtIiwic2F2ZUJsb2NrcyIsIndvcmtzcGFjZVRvRG9tIiwieG1sX3RleHQiLCJkb21Ub1RleHQiLCJmaWxlbmFtZSIsImxpbmsiLCJkb3dubG9hZCIsImhyZWYiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzYXZlQ29kZSIsInNhdmVQcm9ncmFtIiwiZSIsImRyb3Bkb3duIiwibG9hZEJsb2NrcyIsImZpbGVTZWxlY3RvciIsImxvYWRGaWxlbmFtZSIsImZpbGVzIiwicmVhZGVyIiwiRmlsZVJlYWRlciIsInJlYWRBc1RleHQiLCJvbmxvYWQiLCJldiIsInJlc3VsdCIsImxvYWRDb2RlIiwibG9hZFByb2dyYW0iLCJhZGRFdmVudExpc3RlbmVyIiwiYWNlIiwiZWRpdCIsInNldFRoZW1lIiwic2Vzc2lvbiIsInNldE1vZGUiLCJzZXRPcHRpb25zIiwiZm9udFNpemUiLCJvbiIsInRhcmdldCIsInJlc2l6ZSIsInciLCJpbm5lcldpZHRoIiwiaCIsImNsaWVudEhlaWdodCIsInAiLCJjbGllbnRXaWR0aCIsInNldEF0dHJpYnV0ZSIsIkN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsIm9ucmVzaXplIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FB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VGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvVXNlcnMvYW50b2luZWNob3BwaW4vZGV2L2dpdGh1Yi9wZW5ndWluQmxvY2tseS9wdWJsaWNcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi9tYWluLmpzXCIpO1xuIiwiY29uc3Qgd29ya3NwYWNlID0gQmxvY2tseS5pbmplY3QoXG4gICAgJ2Jsb2NrbHlQYW5lbCcsIHtcbiAgICAgICAgdG9vbGJveDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rvb2xib3gnKSxcbiAgICAgICAgZ3JpZDoge1xuICAgICAgICAgICAgc3BhY2luZzogMTgsXG4gICAgICAgICAgICBsZW5ndGg6IDMsXG4gICAgICAgICAgICBjb2xvdXI6ICcjY2NjJyxcbiAgICAgICAgICAgIHNuYXA6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHRyYXNoY2FuOiB0cnVlLFxuICAgICAgICB6b29tOiB7XG4gICAgICAgICAgICBjb250cm9sczogdHJ1ZSxcbiAgICAgICAgICAgIHN0YXJ0U2NhbGU6IDEuMCxcbiAgICAgICAgICAgIG1heFNjYWxlOiAzLFxuICAgICAgICAgICAgbWluU2NhbGU6IDAuMyxcbiAgICAgICAgICAgIHNjYWxlU3BlZWQ6IDEuMixcbiAgICAgICAgfSxcbiAgICB9LFxuKTtcblxuY29uc3QgY3JlYXRlUHNldWRvQ29udGV4dCA9IGZ1bmN0aW9uKGludGVycHJldGVyLCBjb250ZXh0KSB7XG4gICAgdmFyIG15Q29udGV4dCA9IGludGVycHJldGVyLmNyZWF0ZU9iamVjdFByb3RvKGludGVycHJldGVyLk9CSkVDVF9QUk9UTyk7XG4gICAgdmFyIGNvbnRleHRGdW5jdGlvbnMgPSBbJ2JlZ2luUGF0aCcsICdzdHJva2UnLCAnZmlsbCcsXG4gICAgICAgICdtb3ZlVG8nLCAnbGluZVRvJywgJ2ZpbGxSZWN0JywgJ3N0cm9rZVJlY3QnLCAnY2xlYXJSZWN0JywgJ2FyYydcbiAgICBdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29udGV4dEZ1bmN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBmbiA9IGNvbnRleHRGdW5jdGlvbnNbaV07XG4gICAgICAgIHZhciB3cmFwcGVyO1xuICAgICAgICBzd2l0Y2ggKGNvbnRleHRbZm5dLmxlbmd0aCkgeyAvLyBDaGVjayBhcml0eVxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHdyYXBwZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGludGVycHJldGVyLmNyZWF0ZVByaW1pdGl2ZShjb250ZXh0W2ZuXS5jYWxsKGNvbnRleHQpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHdyYXBwZXIgPSBmdW5jdGlvbihhcmcwLCBhcmcxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnRlcnByZXRlci5jcmVhdGVQcmltaXRpdmUoY29udGV4dFtmbl0uY2FsbChjb250ZXh0LCBhcmcwLCBhcmcxKSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICB3cmFwcGVyID0gZnVuY3Rpb24oYXJnMCwgYXJnMSwgYXJnMiwgYXJnMykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW50ZXJwcmV0ZXIuY3JlYXRlUHJpbWl0aXZlKGNvbnRleHRbZm5dLmNhbGwoY29udGV4dCwgYXJnMCwgYXJnMSwgYXJnMiwgYXJnMykpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgd3JhcHBlciA9IGZ1bmN0aW9uKGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGludGVycHJldGVyLmNyZWF0ZVByaW1pdGl2ZShjb250ZXh0W2ZuXS5jYWxsKGNvbnRleHQsIGFyZzAsIGFyZzEsIGFyZzIsIGFyZzMsIGFyZzQpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGludGVycHJldGVyLnNldFByb3BlcnR5KG15Q29udGV4dCwgZm4sXG4gICAgICAgICAgICBpbnRlcnByZXRlci5jcmVhdGVOYXRpdmVGdW5jdGlvbih3cmFwcGVyLCBmYWxzZSksXG4gICAgICAgICAgICBJbnRlcnByZXRlci5OT05FTlVNRVJBQkxFX0RFU0NSSVBUT1IpO1xuICAgIH1cbiAgICBjb25zdCBjb250ZXh0UHJvcGVydGllcyA9IFsnZmlsbFN0eWxlJywgJ3N0cm9rZVN0eWxlJywgJ2xpbmVXaWR0aCddO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29udGV4dFByb3BlcnRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgcHJvcCA9IGNvbnRleHRQcm9wZXJ0aWVzW2ldO1xuICAgICAgICB2YXIgZ2V0UHJvcCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIGludGVycHJldGVyLmNyZWF0ZVByaW1pdGl2ZShjb250ZXh0W3Byb3BdKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNldFByb3AgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgICAgY29udGV4dFtwcm9wXSA9IHZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGludGVycHJldGVyLmNyZWF0ZU5hdGl2ZUZ1bmN0aW9uKGdldFByb3AsIGZhbHNlKSxcbiAgICAgICAgICAgIHNldDogaW50ZXJwcmV0ZXIuY3JlYXRlTmF0aXZlRnVuY3Rpb24oc2V0UHJvcCwgZmFsc2UpXG4gICAgICAgIH07XG4gICAgICAgIGludGVycHJldGVyLnNldFByb3BlcnR5KG15Q29udGV4dCwgcHJvcCwgSW50ZXJwcmV0ZXIuVkFMVUVfSU5fREVTQ1JJUFRPUiwgZGVzY3JpcHRvcik7XG4gICAgfVxuICAgIHJldHVybiBteUNvbnRleHQ7XG59O1xuXG5jb25zdCBjcmVhdGVQc2V1ZG9DYW52YXMgPSBmdW5jdGlvbihpbnRlcnByZXRlciwgY2FudmFzKSB7XG4gICAgdmFyIG15Q2FudmFzID0gaW50ZXJwcmV0ZXIuY3JlYXRlT2JqZWN0UHJvdG8oaW50ZXJwcmV0ZXIuT0JKRUNUX1BST1RPKTtcblxuICAgIGZ1bmN0aW9uIGdldENvbnRleHRXcmFwcGVyKHR5cGUpIHtcbiAgICAgICAgaWYgKHR5cGUgIT09ICcyZCcpIHtcbiAgICAgICAgICAgIHRocm93IElsbGVnYWxBcmd1bWVudCgnT25seSAyZCBjb250ZXh0IGlzIHN1cHBvcnRlZCAoZ290ICcgKyB0eXBlICsgJyknKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlQ29udGV4dCA9IGludGVycHJldGVyLmNyZWF0ZVByaW1pdGl2ZShjYW52YXMuZ2V0Q29udGV4dCh0eXBlKSk7XG4gICAgICAgIHJldHVybiBjcmVhdGVQc2V1ZG9Db250ZXh0KGludGVycHJldGVyLCBuYXRpdmVDb250ZXh0KTtcbiAgICB9XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkobXlDYW52YXMsICdnZXRDb250ZXh0JyxcbiAgICAgICAgaW50ZXJwcmV0ZXIuY3JlYXRlTmF0aXZlRnVuY3Rpb24oZ2V0Q29udGV4dFdyYXBwZXIsIGZhbHNlKSxcbiAgICAgICAgSW50ZXJwcmV0ZXIuTk9ORU5VTUVSQUJMRV9ERVNDUklQVE9SKTtcbiAgICByZXR1cm4gbXlDYW52YXM7XG59O1xuXG5jb25zdCBpbml0RG9jdW1lbnQgPSBmdW5jdGlvbihpbnRlcnByZXRlciwgc2NvcGUpIHtcbiAgICB2YXIgbXlEb2N1bWVudCA9IGludGVycHJldGVyLmNyZWF0ZU9iamVjdFByb3RvKGludGVycHJldGVyLk9CSkVDVF9QUk9UTyk7XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkoc2NvcGUsICdkb2N1bWVudCcsIG15RG9jdW1lbnQpO1xuXG4gICAgZnVuY3Rpb24gZ2V0RWxlbWVudFdyYXBwZXIoaWQpIHtcbiAgICAgICAgdmFyIG5hdGl2ZUVsZW1lbnQgPSBpbnRlcnByZXRlci5jcmVhdGVQcmltaXRpdmUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpKTtcbiAgICAgICAgaWYgKG5hdGl2ZUVsZW1lbnQudGFnTmFtZSAhPT0gJ0NBTlZBUycpIHtcbiAgICAgICAgICAgIHRocm93IFR5cGVFcnJvcignT25seSBDYW52YXMgRE9NIGVsZW1lbnQgaXMgc3VwcG9ydGVkIChnb3QgJyArIHR5cGVvZihuYXRpdmVFbGVtZW50KSArICcpJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZVBzZXVkb0NhbnZhcyhpbnRlcnByZXRlciwgbmF0aXZlRWxlbWVudCk7XG4gICAgfVxuICAgIGludGVycHJldGVyLnNldFByb3BlcnR5KG15RG9jdW1lbnQsICdnZXRFbGVtZW50QnlJZCcsXG4gICAgICAgIGludGVycHJldGVyLmNyZWF0ZU5hdGl2ZUZ1bmN0aW9uKGdldEVsZW1lbnRXcmFwcGVyLCBmYWxzZSksXG4gICAgICAgIEludGVycHJldGVyLk5PTkVOVU1FUkFCTEVfREVTQ1JJUFRPUik7XG59O1xuXG5jb25zdCBpbml0Q29uc29sZSA9IGZ1bmN0aW9uKGludGVycHJldGVyLCBzY29wZSkge1xuICAgIHZhciBteUNvbnNvbGUgPSBpbnRlcnByZXRlci5jcmVhdGVPYmplY3RQcm90byhpbnRlcnByZXRlci5PQkpFQ1RfUFJPVE8pO1xuICAgIGludGVycHJldGVyLnNldFByb3BlcnR5KHNjb3BlLCAnY29uc29sZScsIG15Q29uc29sZSk7XG4gICAgdmFyIGNvbnNvbGVGdW5jdGlvbnMgPSBbJ2xvZyddO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uc29sZUZ1bmN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpbnRlcnByZXRlci5zZXRQcm9wZXJ0eShteUNvbnNvbGUsIGNvbnNvbGVGdW5jdGlvbnNbaV0sXG4gICAgICAgICAgICBpbnRlcnByZXRlci5jcmVhdGVOYXRpdmVGdW5jdGlvbihjb25zb2xlW2NvbnNvbGVGdW5jdGlvbnNbaV1dLCBmYWxzZSksXG4gICAgICAgICAgICBJbnRlcnByZXRlci5OT05FTlVNRVJBQkxFX0RFU0NSSVBUT1IpO1xuICAgIH1cbn07XG5cbmNvbnN0IGluaXRXaW5kb3cgPSBmdW5jdGlvbihpbnRlcnByZXRlciwgc2NvcGUpIHtcbiAgICBmdW5jdGlvbiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVXcmFwcGVyKGFuaW1hdGlvbkNhbGxiYWNrLCBjYWxsYmFjaykge1xuICAgICAgICBmdW5jdGlvbiBjYWxsYmFja1dyYXBwZXIoKSB7XG4gICAgICAgICAgICBjb25zdCBzdGFjayA9IGludGVycHJldGVyLnN0YXRlU3RhY2s7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50U3RhdGUgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIGNvbnN0IGZuTmFtZSA9IGN1cnJlbnRTdGF0ZS5ub2RlLmFyZ3VtZW50c1swXS5uYW1lO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvb2tpbmcgZm9yICcgKyBmbk5hbWUgKyAnIGluIGNhbGwgc3RhY2suJyk7XG4gICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBpID0gc3RhY2subGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIGZvciAoOyBpID4gMDsgaSAtLSkge1xuICAgICAgICAgICAgICAgIHZhciBzID0gc3RhY2tbaV07XG4gICAgICAgICAgICAgICAgaWYgKHMubm9kZS50eXBlID09PSAnQ2FsbEV4cHJlc3Npb24nICYmXG4gICAgICAgICAgICAgICAgICAgIHMubm9kZS5jYWxsZWUubmFtZSA9PT0gZm5OYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgIHRocm93IEV2YWxFcnJvcignQ291bGQgbm90IGZpbmQgJyArIGZuTmFtZSArICcgaW4gY2FsbCBzdGFjay4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGogPSBzdGFjay5sZW5ndGggLSAxOyBqID4gaTsgaiAtLSkge1xuICAgICAgICAgICAgICAgIHN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHN0YXRlID0gc3RhY2tbc3RhY2subGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBzdGF0ZS5kb25lQ2FsbGVlXyA9IDA7XG4gICAgICAgICAgICBzdGF0ZS5kb25lRXhlY18gPSBmYWxzZTtcbiAgICAgICAgICAgIHN0YXRlLmRvbmVBcmdzXyA9IGZhbHNlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3RhdGUpO1xuICAgICAgICAgICAgc3RhY2sucHVzaChjdXJyZW50U3RhdGUpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc3RhY2tbc3RhY2subGVuZ3RoIC0gMV0pO1xuICAgICAgICAgICAgLy8gZGVidWdnZXI7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnRlcnByZXRlci5jcmVhdGVQcmltaXRpdmUod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShjYWxsYmFja1dyYXBwZXIpKTtcbiAgICB9XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkoc2NvcGUsICdyZXF1ZXN0QW5pbWF0aW9uRnJhbWUnLFxuICAgICAgICBpbnRlcnByZXRlci5jcmVhdGVBc3luY0Z1bmN0aW9uKHJlcXVlc3RBbmltYXRpb25GcmFtZVdyYXBwZXIpLFxuICAgICAgICBJbnRlcnByZXRlci5OT05FTlVNRVJBQkxFX0RFU0NSSVBUT1IpO1xufTtcblxuY29uc3QgaW5pdEhpZ2hsaWdodCA9IGZ1bmN0aW9uKGludGVycHJldGVyLCBzY29wZSkge1xuICAgIHZhciBoaWdobGlnaHRCbG9ja1dyYXBwZXIgPSBmdW5jdGlvbihpZCwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHJldCA9IHdvcmtzcGFjZS5oaWdobGlnaHRCbG9jayhpZCk7XG4gICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDApO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH07XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkoc2NvcGUsICdoaWdobGlnaHRCbG9jaycsXG4gICAgICAgIGludGVycHJldGVyLmNyZWF0ZUFzeW5jRnVuY3Rpb24oaGlnaGxpZ2h0QmxvY2tXcmFwcGVyKSk7XG5cbiAgICB2YXIgaGlnaGxpZ2h0TGluZVdyYXBwZXIgPSBmdW5jdGlvbihsaW5lTnVtLCBjYWxsYmFjaykge1xuICAgICAgICBpZiAoLTEgPT09IGxpbmVOdW0pIHtcbiAgICAgICAgICAgIGVkaXRvci5zZWxlY3Rpb24uY2xlYXJTZWxlY3Rpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGVkaXRvci5zZWxlY3Rpb24ubW92ZUN1cnNvclRvUG9zaXRpb24oe3JvdzogbGluZU51bSwgY29sdW1uOiAwfSk7XG4gICAgICAgICAgICBlZGl0b3Iuc2VsZWN0aW9uLnNlbGVjdExpbmUoKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIDEwMDApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkoc2NvcGUsICdoaWdobGlnaHRMaW5lJyxcbiAgICAgICAgaW50ZXJwcmV0ZXIuY3JlYXRlQXN5bmNGdW5jdGlvbihoaWdobGlnaHRMaW5lV3JhcHBlcikpO1xuXG4gICAgZnVuY3Rpb24gYWxlcnRXcmFwcGVyKHRleHQpIHtcbiAgICAgICAgY29uc3QgbXNnID0gdGV4dCA/IHRleHQudG9TdHJpbmcoKSA6ICcnO1xuICAgICAgICByZXR1cm4gaW50ZXJwcmV0ZXIuY3JlYXRlUHJpbWl0aXZlKHdpbmRvdy5hbGVydChtc2cpKTtcbiAgICB9XG4gICAgaW50ZXJwcmV0ZXIuc2V0UHJvcGVydHkoc2NvcGUsICdhbGVydCcsXG4gICAgICAgIGludGVycHJldGVyLmNyZWF0ZU5hdGl2ZUZ1bmN0aW9uKGFsZXJ0V3JhcHBlcikpO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlSW50ZXJwcmV0ZXIoY29kZSkge1xuICAgIGZ1bmN0aW9uIGluaXRpYWxpemUoaW50ZXJwcmV0ZXIsIHNjb3BlKSB7XG4gICAgICAgIGluaXREb2N1bWVudChpbnRlcnByZXRlciwgc2NvcGUpO1xuICAgICAgICBpbml0Q29uc29sZShpbnRlcnByZXRlciwgc2NvcGUpO1xuICAgICAgICBpbml0V2luZG93KGludGVycHJldGVyLCBzY29wZSk7XG4gICAgICAgIGluaXRIaWdobGlnaHQoaW50ZXJwcmV0ZXIsIHNjb3BlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJbnRlcnByZXRlcihjb2RlLCBpbml0aWFsaXplKTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVDb2RlKHdvcmtzcGFjZSwgaGlnaGxpZ2h0QmxvY2tzID0gZmFsc2UpIHtcbiAgICBpZiAoaGlnaGxpZ2h0QmxvY2tzKSB7XG4gICAgICAgIEJsb2NrbHkuSmF2YVNjcmlwdC5TVEFURU1FTlRfUFJFRklYID0gJ2hpZ2hsaWdodEJsb2NrKCUxKTtcXG4nO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgQmxvY2tseS5KYXZhU2NyaXB0LlNUQVRFTUVOVF9QUkVGSVggPSAnJztcbiAgICB9XG4gICAgdmFyIGNvZGUgPSBCbG9ja2x5LkphdmFTY3JpcHQud29ya3NwYWNlVG9Db2RlKHdvcmtzcGFjZSk7XG4gICAgaWYgKGhpZ2hsaWdodEJsb2Nrcykge1xuICAgICAgICBjb2RlICs9IFwiaGlnaGxpZ2h0QmxvY2sobnVsbCk7XFxuXCI7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGNvZGUpO1xuICAgIHJldHVybiBjb2RlO1xufVxuXG52YXIgcnVubmluZyA9IGZhbHNlO1xudmFyIG11c3RTdG9wID0gZmFsc2U7XG5zZXRSdW5uaW5nKGZhbHNlKTtcblxuZnVuY3Rpb24gYW5ub3RhdGVDb2RlRm9yU3RvcHBpbmcoY29kZSkge1xuICAgIGNvbnN0IGxpbmVzID0gY29kZS5zcGxpdChcIlxcblwiKTtcbiAgICB2YXIgYW5ub3RhdGVkTGluZXMgPSBbXTtcbiAgICBsaW5lcy5mb3JFYWNoKChsLCBpKSA9PiB7XG4gICAgICAgIGFubm90YXRlZExpbmVzWzIqaV0gPSBsO1xuICAgICAgICBhbm5vdGF0ZWRMaW5lc1syKmkrMV0gPSAnaWYgKG11c3RTdG9wKSB7IHNldFJ1bm5pbmcoZmFsc2UpOyB0aHJvdyBFdmFsRXJyb3IoXCJTdG9wcGVkLlwiKTsgfSc7XG4gICAgfSk7XG4gICAgdmFyIGFubm90YXRlZENvZGUgPSBhbm5vdGF0ZWRMaW5lcy5qb2luKFwiXFxuXCIpO1xuICAgIGlmIChhbm5vdGF0ZWRDb2RlLmluZGV4T2YoJ3JlcXVlc3RBbmltYXRpb25GcmFtZScpID09PSAtMSAmJlxuICAgICAgICBhbm5vdGF0ZWRDb2RlLmluZGV4T2YoJ3NldFRpbWVvdXQnKSA9PT0gLTEpIHtcbiAgICAgICAgYW5ub3RhdGVkQ29kZSArPSAnXFxuc2V0UnVubmluZyhmYWxzZSk7XFxuJztcbiAgICB9XG4gICAgcmV0dXJuIGFubm90YXRlZENvZGU7XG59XG5cbmZ1bmN0aW9uIHJ1bkJsb2NrcygpIHtcbiAgICBzZXRSdW5uaW5nKHRydWUpO1xuICAgIGNvbnN0IGNvZGUgPSBhbm5vdGF0ZUNvZGVGb3JTdG9wcGluZyhnZW5lcmF0ZUNvZGUod29ya3NwYWNlLCBmYWxzZSkpO1xuICAgIGV2YWwoY29kZSk7XG59XG5cbmZ1bmN0aW9uIGRlYnVnQmxvY2tzKCkge1xuICAgIHNldFJ1bm5pbmcodHJ1ZSk7XG4gICAgY29uc3QgY29kZSA9IGdlbmVyYXRlQ29kZSh3b3Jrc3BhY2UsIHRydWUpO1xuICAgIGNvbnN0IGpzSW50ZXJwcmV0ZXIgPSBjcmVhdGVJbnRlcnByZXRlcihjb2RlKTtcbiAgICB2YXIgcnVuT25jZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoanNJbnRlcnByZXRlci5ydW4oKSAmJiAhbXVzdFN0b3ApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQocnVuT25jZSwgMTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAobXVzdFN0b3ApIHtcbiAgICAgICAgICAgICAgICB3b3Jrc3BhY2UuaGlnaGxpZ2h0QmxvY2sobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRSdW5uaW5nKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcnVuT25jZSgpO1xufVxuXG5mdW5jdGlvbiBydW5Db2RlKCkge1xuICAgIHNldFJ1bm5pbmcodHJ1ZSk7XG4gICAgY29uc3QgY29kZSA9IGFubm90YXRlQ29kZUZvclN0b3BwaW5nKGVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0VmFsdWUoKSk7XG4gICAgZXZhbChjb2RlKTtcbn1cblxuZnVuY3Rpb24gYW5ub3RhdGVDb2RlRm9ySGlnaGxpZ2h0KGNvZGUpIHtcbiAgICBjb25zdCBsaW5lcyA9IGNvZGUuc3BsaXQoXCJcXG5cIik7XG4gICAgdmFyIGFubm90YXRlZExpbmVzID0gW107XG4gICAgbGluZXMuZm9yRWFjaCgobCwgaSkgPT4ge1xuICAgICAgICBhbm5vdGF0ZWRMaW5lc1syKmldID0gJ2hpZ2hsaWdodExpbmUoJyArIGkgKyAnKTsnO1xuICAgICAgICBhbm5vdGF0ZWRMaW5lc1syKmkrMV0gPSBsO1xuICAgIH0pO1xuICAgIHJldHVybiBhbm5vdGF0ZWRMaW5lcy5qb2luKFwiXFxuXCIpICsgJ2hpZ2hsaWdodExpbmUoLTEpOyc7XG59XG5cbmZ1bmN0aW9uIGRlYnVnQ29kZSgpIHtcbiAgICBzZXRSdW5uaW5nKHRydWUpO1xuICAgIGNvbnN0IGNvZGUgPSBhbm5vdGF0ZUNvZGVGb3JIaWdobGlnaHQoZWRpdG9yLmdldFNlc3Npb24oKS5nZXRWYWx1ZSgpKTtcbiAgICBjb25zb2xlLmxvZyhjb2RlKTtcbiAgICBjb25zdCBqc0ludGVycHJldGVyID0gY3JlYXRlSW50ZXJwcmV0ZXIoY29kZSk7XG4gICAgdmFyIHJ1bk9uY2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGpzSW50ZXJwcmV0ZXIucnVuKCkgJiYgIW11c3RTdG9wKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bk9uY2UsIDEwMDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKG11c3RTdG9wKSB7XG4gICAgICAgICAgICAgICAgZWRpdG9yLnNlbGVjdGlvbi5jbGVhclNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0UnVubmluZyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJ1bk9uY2UoKTtcbn1cblxuZnVuY3Rpb24gaXNCbG9ja2x5VmlzaWJsZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jsb2NrbHknKS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpO1xufVxuXG5mdW5jdGlvbiBydW5Qcm9ncmFtKCkge1xuICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzQmxvY2tseVZpc2libGUoKSkge1xuICAgICAgICBydW5CbG9ja3MoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJ1bkNvZGUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRlYnVnUHJvZ3JhbSgpIHtcbiAgICBpZiAocnVubmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChpc0Jsb2NrbHlWaXNpYmxlKCkpIHtcbiAgICAgICAgZGVidWdCbG9ja3MoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGRlYnVnQ29kZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc3RvcFByb2dyYW0oKSB7XG4gICAgaWYgKCFydW5uaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbXVzdFN0b3AgPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBzZXRSdW5uaW5nKHZhbHVlKSB7XG4gICAgcnVubmluZyA9IHZhbHVlO1xuICAgIG11c3RTdG9wID0gZmFsc2U7XG4gICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgJCgnI3J1bkJ0bicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAkKCcjZGVidWdCdG4nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnI3NhbXBsZUJ0bicpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAkKCcjc2F2ZURyb3Bkb3duTGluaycpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAkKCcjbG9hZERyb3Bkb3duTGluaycpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAkKCcjc3RvcEJ0bicpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAkKCcubmF2LWxpbmsnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgICQoJyNydW5CdG4nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnI2RlYnVnQnRuJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICQoJyNzYW1wbGVCdG4nKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnI3NhdmVEcm9wZG93bkxpbmsnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnI2xvYWREcm9wZG93bkxpbmsnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnI3N0b3BCdG4nKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgJCgnLm5hdi1saW5rJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzYW1wbGVCbG9ja3NfKCkge1xuICAgIHZhciBibG9ja3MgPSBmdW5jdGlvbigpIHtcbi8qXG48eG1sIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiPlxuICAgIDx2YXJpYWJsZXM+PC92YXJpYWJsZXM+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX2dldGNvbnRleHQyZFwiIGlkPVwiez97UyhoIXFMdX45Kzh8c3FxVWZcIiB4PVwiMjhcIiB5PVwiMjNcIj48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fY2xlYXJyZWN0XCIgaWQ9XCJgaVAuXzcxcnc9I3orantld00xMVwiPjx2YWx1ZSBuYW1lPVwieFwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cImguZltJZEwjXTQ9cix8WnJPW2RuXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4wPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ5XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiaD0ha29KU35NfGBHWzFjPXdESDlcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cIndpZHRoXCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiMl8oYEdFU2VtPzNOQH5KJWkreV1cIj48ZmllbGQgbmFtZT1cIk5VTVwiPjgwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwiaGVpZ2h0XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwibmwrTmUyL1NreGRiW1prdzJEcGxcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjYwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9maWxsc3R5bGVcIiBpZD1cIiVsKHxtLmlyd3JsI31pRGRyNisxXCI+PGZpZWxkIG5hbWU9XCJjb2xvclwiPmxpZ2h0Ymx1ZTwvZmllbGQ+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX2ZpbGxyZWN0XCIgaWQ9XCJvI2ZPe29vMERKNkQ3OXVqeyg7ZFwiPjx2YWx1ZSBuYW1lPVwieFwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIlUrIUozSEMyNDVhQGpZZyFlKWlqXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4wPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ5XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiZkwzUFpQLDlCNmI1JG5SRlc3RylcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cIndpZHRoXCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiTDg/ZHtFLy4zNG1ULHlqOEAtKzRcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjgwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwiaGVpZ2h0XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiMFtVUURaJDpxXXw1WF0kVUxsL2ZcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjYwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9maWxsc3R5bGVcIiBpZD1cIlddX29mbHAkS3sxTXltQS5DSz8uXCI+PGZpZWxkIG5hbWU9XCJjb2xvclwiPmdyZWVuPC9maWVsZD48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fZmlsbHJlY3RcIiBpZD1cIm9nMnp0aCpbTC5TP0xdJGI4QmpfXCI+PHZhbHVlIG5hbWU9XCJ4XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiSDZXYW86LF98dVRsc0pLKFBpZClcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cInlcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCI4XkYjeF1IaXxhMmRVKyNIOlFXOlwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+NTAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ3aWR0aFwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIkZMaThGUDMlO1UuOE8pfi5PWz9hXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj44MDA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cImhlaWdodFwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIlZ7RTgwQ2lIWWxYaiQ7L31XfiVkXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4xMDA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fc3Ryb2tlc3R5bGVcIiBpZD1cIm87cSpGTWxuV11Pa1txWEBbdmQ9XCI+PGZpZWxkIG5hbWU9XCJjb2xvclwiPmJyb3duPC9maWVsZD48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fc3Ryb2tlcGF0aFwiIGlkPVwic1hrZUdeWTJscnpWLSR2XzNWXSpcIj48c3RhdGVtZW50IG5hbWU9XCJwYXRoX2Jsb2NrXCI+PGJsb2NrIHR5cGU9XCJwZW5ndWluX2xpbmV3aWR0aFwiIGlkPVwiQyVhYVJKLnVNYEszQzI1bUdZNHpcIj48dmFsdWUgbmFtZT1cIndpZHRoXCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiX2l3X0d9XTYyQ2x+fWddVXduRE5cIj48ZmllbGQgbmFtZT1cIk5VTVwiPjEwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX21vdmV0b1wiIGlkPVwiMjt8N3F1YVI5OURZJUR0UVRaRi1cIj48dmFsdWUgbmFtZT1cInhcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJnVjUtOFQ6KD9VSVRJKGlPTUpTYFwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+MjAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ5XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiTTV8Knt5fHN3eXRsNTFqS1pReUpcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjUwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9saW5ldG9cIiBpZD1cIlhLeXgvJGFedWxaVDdjdGJVV2ZhXCI+PHZhbHVlIG5hbWU9XCJ4XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwieVBTeWpHKUI1W2RMZUhTSVBvaipcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjIwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwieVwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIistXk55UnF0Wm1pU1JVOG4rUUBHXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj40MDA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48L2Jsb2NrPjwvbmV4dD5cbiAgICA8L2Jsb2NrPjwvbmV4dD5cbiAgICA8L2Jsb2NrPjwvc3RhdGVtZW50PjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9zdHJva2VwYXRoXCIgaWQ9XCJFIU9SO01SVzNWVyVCb3BrfFktN1wiPjxzdGF0ZW1lbnQgbmFtZT1cInBhdGhfYmxvY2tcIj48YmxvY2sgdHlwZT1cInBlbmd1aW5fbGluZXdpZHRoXCIgaWQ9XCIlUmYvNV53eUtOW0JyUCEsc2wzU1wiPjx2YWx1ZSBuYW1lPVwid2lkdGhcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJOeVRefWYlP2YkckE0bldkfW5oPVwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+NTwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9tb3ZldG9cIiBpZD1cIldEcDRmZ0QlMix8YXcjaX5QYnxGXCI+PHZhbHVlIG5hbWU9XCJ4XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwib0BYfUkhKVRyRDp2aXhpMEVPbmhcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjIwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwieVwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cInpgU01UfCxZWUxFOXZEY3Q6dk9NXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj40MDA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fbGluZXRvXCIgaWQ9XCIpVSQhLWxyKGl1bjdOXVA1dDtYNFwiPjx2YWx1ZSBuYW1lPVwieFwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIkpkW1olP1hMb0lbMWp7P097V1tqXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4xNTA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cInlcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJRdzcwSiRKd0ckUihTQT1ubiR5JFwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+MzUwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX21vdmV0b1wiIGlkPVwib19ocDYvb3coUl8kWGItaSE4WSVcIj48dmFsdWUgbmFtZT1cInhcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJiWiMkdV5HWkpsVnchcS45VmZHNVwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+MjAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ5XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwib21QRjA/Om1VU3dVLypWQCRRcGNcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjQwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjxuZXh0PlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9saW5ldG9cIiBpZD1cImpJKXktVDNlODF5RmBXVjVhcFFUXCI+PHZhbHVlIG5hbWU9XCJ4XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiLzY/IzpCKX1YallqaD02Zk95XmJcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjIyMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwieVwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIm9faD8hRHxNd1I1O0kqRV40fVA1XCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4zODA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48L2Jsb2NrPjwvbmV4dD5cbiAgICA8L2Jsb2NrPjwvbmV4dD48L2Jsb2NrPjwvbmV4dD48L2Jsb2NrPjwvbmV4dD48L2Jsb2NrPjwvc3RhdGVtZW50PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+XG48L3htbD5cbiovXG4gICAgfS50b1N0cmluZygpLnNwbGl0KFwiXFxuXCIpLnNsaWNlKDIsIC0yKS5qb2luKFwiXFxuXCIpO1xuICAgIHZhciB4bWwgPSBCbG9ja2x5LlhtbC50ZXh0VG9Eb20oYmxvY2tzKTtcbiAgICBCbG9ja2x5LlhtbC5kb21Ub1dvcmtzcGFjZSh4bWwsIHdvcmtzcGFjZSk7XG59XG5cbmZ1bmN0aW9uIHNhbXBsZUJsb2NrcygpIHtcbi8vIFByb2dyYW0gdG8gcnVuIGFuaW1hdGlvblxuICAgIHZhciBibG9ja3MgPSBmdW5jdGlvbigpIHtcbi8qXG48eG1sIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiPlxuICAgIDx2YXJpYWJsZXM+PHZhcmlhYmxlIHR5cGU9XCJcIiBpZD1cIiVocWsqLld0V2I2P1s/ZEdebVNiXCI+eDwvdmFyaWFibGU+PHZhcmlhYmxlIHR5cGU9XCJcIiBpZD1cIihKeSFSJVN4dzskIVY5fCxtKVAxXCI+dng8L3ZhcmlhYmxlPjwvdmFyaWFibGVzPlxuICAgIDxibG9jayB0eXBlPVwicGVuZ3Vpbl9nZXRjb250ZXh0MmRcIiBpZD1cInY3OmlhTSpTIVB7cGl+KDd0bkdBXCIgeD1cIjI4XCIgeT1cIjEyXCI+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJ2YXJpYWJsZXNfc2V0XCIgaWQ9XCJqQVt4SnNjcltrLD9DdChGW3kxT1wiPjxmaWVsZCBuYW1lPVwiVkFSXCIgaWQ9XCIlaHFrKi5XdFdiNj9bP2RHXm1TYlwiIHZhcmlhYmxldHlwZT1cIlwiPng8L2ZpZWxkPjx2YWx1ZSBuYW1lPVwiVkFMVUVcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJ8TlFTMjR7RkJBQEYrVS9hdHQ6VVwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+MTAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJ2YXJpYWJsZXNfc2V0XCIgaWQ9XCJpUlMhPSFNe0I7VTh8UEUsTnhHUFwiPjxmaWVsZCBuYW1lPVwiVkFSXCIgaWQ9XCIoSnkhUiVTeHc7JCFWOXwsbSlQMVwiIHZhcmlhYmxldHlwZT1cIlwiPnZ4PC9maWVsZD48dmFsdWUgbmFtZT1cIlZBTFVFXCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiZiVRfWVKY0UweU1LZ1oyY31HVyRcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjEwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX2ZpbGxzdHlsZVwiIGlkPVwiJUA/QyhqW35gM1p8fFdqMFM4JS5cIj48ZmllbGQgbmFtZT1cImNvbG9yXCI+cmVkPC9maWVsZD48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cInBlbmd1aW5fYW5pbWF0aW9uXCIgaWQ9XCJkMWM6K2t6V3luUWlDfERwYHxJSlwiPjxzdGF0ZW1lbnQgbmFtZT1cImFuaW1hdGlvbl9ibG9ja1wiPjxibG9jayB0eXBlPVwicGVuZ3Vpbl9jbGVhcnJlY3RcIiBpZD1cInBlRSRCVGUhV0g9V1hrd1plTyNeXCI+PHZhbHVlIG5hbWU9XCJ4XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiQXwpMjtlc1h+OlhsbkM0SUMtW2tcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cInlcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCIxTzFUJCpXVnVfNTp7fFFVKDJ7O1wiPjxmaWVsZCBuYW1lPVwiTlVNXCI+MDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwid2lkdGhcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCIrSkg4NSVDKyt5XShlfX16KHpte1wiPjxmaWVsZCBuYW1lPVwiTlVNXCI+ODAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJoZWlnaHRcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJ1QzF7eUtdcV1LKCRsRFNiRiNUc1wiPjxmaWVsZCBuYW1lPVwiTlVNXCI+NjAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJwZW5ndWluX2ZpbGxwYXRoXCIgaWQ9XCJvZF89VTBPKyEuWVdEX0t8SDsuT1wiPjxzdGF0ZW1lbnQgbmFtZT1cInBhdGhfYmxvY2tcIj48YmxvY2sgdHlwZT1cInBlbmd1aW5fY2lyY2xlXCIgaWQ9XCJEaXF4W3cjWC52fkVic0p5Wy1VZ1wiPjx2YWx1ZSBuYW1lPVwieFwiPjxibG9jayB0eXBlPVwidmFyaWFibGVzX2dldFwiIGlkPVwiKDYwU2BAbHIrTkcuM1IzX1JvOk1cIj48ZmllbGQgbmFtZT1cIlZBUlwiIGlkPVwiJWhxayouV3RXYjY/Wz9kR15tU2JcIiB2YXJpYWJsZXR5cGU9XCJcIj54PC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJ5XCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwiO3FtenFdOUQ3Km8rczJCczQ1O3pcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjQwMDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwicmFkaXVzXCI+PGJsb2NrIHR5cGU9XCJtYXRoX251bWJlclwiIGlkPVwidFFTKD9BZ0lRT2BeLjtwTTJhVllcIj48ZmllbGQgbmFtZT1cIk5VTVwiPjUwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PG5leHQ+XG4gICAgPGJsb2NrIHR5cGU9XCJtYXRoX2NoYW5nZVwiIGlkPVwiVlpSMitsJXxOanA3ZDY0clVUc15cIj48ZmllbGQgbmFtZT1cIlZBUlwiIGlkPVwiJWhxayouV3RXYjY/Wz9kR15tU2JcIiB2YXJpYWJsZXR5cGU9XCJcIj54PC9maWVsZD48dmFsdWUgbmFtZT1cIkRFTFRBXCI+PHNoYWRvdyB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIlhsZHwtKztMUUl5OkB9SEU2NU8zXCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4xPC9maWVsZD48L3NoYWRvdz48YmxvY2sgdHlwZT1cInZhcmlhYmxlc19nZXRcIiBpZD1cIm5ueHxBX1hCNmAvNTpVZTNPZzJJXCI+PGZpZWxkIG5hbWU9XCJWQVJcIiBpZD1cIihKeSFSJVN4dzskIVY5fCxtKVAxXCIgdmFyaWFibGV0eXBlPVwiXCI+dng8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48bmV4dD5cbiAgICA8YmxvY2sgdHlwZT1cImNvbnRyb2xzX2lmXCIgaWQ9XCJmZVtMO0x6MTQsVjUhfFpfUks0L1wiPjx2YWx1ZSBuYW1lPVwiSUYwXCI+PGJsb2NrIHR5cGU9XCJsb2dpY19vcGVyYXRpb25cIiBpZD1cIikjdnR8PV0qcndpfWQxfFhJZl5CXCI+PGZpZWxkIG5hbWU9XCJPUFwiPk9SPC9maWVsZD48dmFsdWUgbmFtZT1cIkFcIj48YmxvY2sgdHlwZT1cImxvZ2ljX2NvbXBhcmVcIiBpZD1cIntuQUVwfEd2YW5xRURjT0JUNDpwXCI+PGZpZWxkIG5hbWU9XCJPUFwiPkxUPC9maWVsZD48dmFsdWUgbmFtZT1cIkFcIj48YmxvY2sgdHlwZT1cInZhcmlhYmxlc19nZXRcIiBpZD1cIktuUXdsUXEhMm84cVdXLjNlbUVvXCI+PGZpZWxkIG5hbWU9XCJWQVJcIiBpZD1cIiVocWsqLld0V2I2P1s/ZEdebVNiXCIgdmFyaWFibGV0eXBlPVwiXCI+eDwvZmllbGQ+PC9ibG9jaz48L3ZhbHVlPjx2YWx1ZSBuYW1lPVwiQlwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIn1MdzR0Uk1hfW14N35aT1k0bTo/XCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4xMDA8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJCXCI+PGJsb2NrIHR5cGU9XCJsb2dpY19jb21wYXJlXCIgaWQ9XCIxdmtqODBZRzheTkQuP3pSOVYuSVwiPjxmaWVsZCBuYW1lPVwiT1BcIj5HVDwvZmllbGQ+PHZhbHVlIG5hbWU9XCJBXCI+PGJsb2NrIHR5cGU9XCJ2YXJpYWJsZXNfZ2V0XCIgaWQ9XCI0Vk9HL2dWZVRbXVBPNjVjOW07XVwiPjxmaWVsZCBuYW1lPVwiVkFSXCIgaWQ9XCIlaHFrKi5XdFdiNj9bP2RHXm1TYlwiIHZhcmlhYmxldHlwZT1cIlwiPng8L2ZpZWxkPjwvYmxvY2s+PC92YWx1ZT48dmFsdWUgbmFtZT1cIkJcIj48YmxvY2sgdHlwZT1cIm1hdGhfbnVtYmVyXCIgaWQ9XCJ+WngzO1IpUEYpbTklRnZdRXpMZVwiPjxmaWVsZCBuYW1lPVwiTlVNXCI+NzAwPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PC9ibG9jaz48L3ZhbHVlPjwvYmxvY2s+PC92YWx1ZT48c3RhdGVtZW50IG5hbWU9XCJETzBcIj48YmxvY2sgdHlwZT1cInZhcmlhYmxlc19zZXRcIiBpZD1cInRPdGlEaHMxIT9MX3BfeFdqUi59XCI+PGZpZWxkIG5hbWU9XCJWQVJcIiBpZD1cIihKeSFSJVN4dzskIVY5fCxtKVAxXCIgdmFyaWFibGV0eXBlPVwiXCI+dng8L2ZpZWxkPjx2YWx1ZSBuYW1lPVwiVkFMVUVcIj48YmxvY2sgdHlwZT1cIm1hdGhfYXJpdGhtZXRpY1wiIGlkPVwiLntQLGJlaXssQH4sbkthKH12NWlcIj48ZmllbGQgbmFtZT1cIk9QXCI+TUlOVVM8L2ZpZWxkPjx2YWx1ZSBuYW1lPVwiQVwiPjxibG9jayB0eXBlPVwibWF0aF9udW1iZXJcIiBpZD1cIl9ha1txYn54UD9eXi9FUCteJXA3XCI+PGZpZWxkIG5hbWU9XCJOVU1cIj4wPC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PHZhbHVlIG5hbWU9XCJCXCI+PGJsb2NrIHR5cGU9XCJ2YXJpYWJsZXNfZ2V0XCIgaWQ9XCI3ek1dUzdqXSpdSDtOe1EwQHF9blwiPjxmaWVsZCBuYW1lPVwiVkFSXCIgaWQ9XCIoSnkhUiVTeHc7JCFWOXwsbSlQMVwiIHZhcmlhYmxldHlwZT1cIlwiPnZ4PC9maWVsZD48L2Jsb2NrPjwvdmFsdWU+PC9ibG9jaz48L3ZhbHVlPjwvYmxvY2s+PC9zdGF0ZW1lbnQ+PC9ibG9jaz48L25leHQ+PC9ibG9jaz48L25leHQ+PC9ibG9jaz48L3N0YXRlbWVudD48L2Jsb2NrPjwvbmV4dD48L2Jsb2NrPjwvc3RhdGVtZW50PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC9uZXh0PjwvYmxvY2s+PC94bWw+XG4qL1xuICAgIH0udG9TdHJpbmcoKS5zcGxpdChcIlxcblwiKS5zbGljZSgyLCAtMikuam9pbihcIlxcblwiKTtcbiAgICB2YXIgeG1sID0gQmxvY2tseS5YbWwudGV4dFRvRG9tKGJsb2Nrcyk7XG4gICAgQmxvY2tseS5YbWwuZG9tVG9Xb3Jrc3BhY2UoeG1sLCB3b3Jrc3BhY2UpO1xufVxuXG5mdW5jdGlvbiBzYW1wbGVDb2RlKCkge1xuICAgIHZhciBjb2RlID0gZnVuY3Rpb24oKSB7XG4vKlxudmFyIGdhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVcIik7XG52YXIgY3R4ID0gZ2FtZS5nZXRDb250ZXh0KFwiMmRcIik7XG5jdHguY2xlYXJSZWN0KDAsMCw4MDAsNjAwKTtcbmN0eC5maWxsU3R5bGUgPSBcImxpZ2h0Ymx1ZVwiO1xuY3R4LmZpbGxSZWN0KDAsMCw4MDAsNjAwKTtcbmN0eC5maWxsU3R5bGUgPSBcImdyZWVuXCI7XG5jdHguZmlsbFJlY3QoMCw1MDAsODAwLDEwMCk7XG5jdHguc3Ryb2tlU3R5bGUgPSBcImJyb3duXCI7XG5jdHguYmVnaW5QYXRoKCk7XG4gIGN0eC5saW5lV2lkdGggPSAxMDtcbiAgY3R4Lm1vdmVUbygyMDAsNTAwKTtcbiAgY3R4LmxpbmVUbygyMDAsNDAwKTtcbmN0eC5zdHJva2UoKTtcbmN0eC5iZWdpblBhdGgoKTtcbiAgY3R4LmxpbmVXaWR0aCA9IDU7XG4gIGN0eC5tb3ZlVG8oMjAwLDQwMCk7XG4gIGN0eC5saW5lVG8oMTUwLDM1MCk7XG4gIGN0eC5tb3ZlVG8oMjAwLDQwMCk7XG4gIGN0eC5saW5lVG8oMjIwLDM4MCk7XG5jdHguc3Ryb2tlKCk7XG4qL1xuICAgIH0udG9TdHJpbmcoKS5zcGxpdChcIlxcblwiKS5zbGljZSgyLCAtMikuam9pbihcIlxcblwiKTtcbiAgICBlZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFZhbHVlKGNvZGUpO1xufVxuXG5mdW5jdGlvbiBzYW1wbGVQcm9ncmFtKCkge1xuICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGlzQmxvY2tseVZpc2libGUoKSkge1xuICAgICAgICBzYW1wbGVCbG9ja3MoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHNhbXBsZUNvZGUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHNhdmVCbG9ja3MoKSB7XG4gICAgY29uc3QgeG1sID0gQmxvY2tseS5YbWwud29ya3NwYWNlVG9Eb20od29ya3NwYWNlKTtcbiAgICBjb25zdCB4bWxfdGV4dCA9IEJsb2NrbHkuWG1sLmRvbVRvVGV4dCh4bWwpO1xuICAgIGNvbnN0IGZpbGVuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVGaWxlbmFtZScpLnZhbHVlO1xuICAgIHZhciBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVCdG4nKTtcbiAgICBsaW5rLmRvd25sb2FkID0gZmlsZW5hbWU7XG4gICAgbGluay5ocmVmID0gJ2RhdGE6dGV4dC94bWw7Y2hhcnNldD11dGYtOCwnICtcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHhtbF90ZXh0KTtcbn1cblxuZnVuY3Rpb24gc2F2ZUNvZGUoKSB7XG4gICAgY29uc3QgY29kZSA9IGVkaXRvci5nZXRTZXNzaW9uKCkuZ2V0VmFsdWUoKTtcbiAgICBjb25zdCBmaWxlbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlRmlsZW5hbWUnKS52YWx1ZTtcbiAgICB2YXIgbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYXZlQnRuJyk7XG4gICAgbGluay5kb3dubG9hZCA9IGZpbGVuYW1lO1xuICAgIGxpbmsuaHJlZiA9ICdkYXRhOnRleHQvcGxhaW47Y2hhcnNldD11dGYtOCwnICtcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KGNvZGUpO1xufVxuXG5mdW5jdGlvbiBzYXZlUHJvZ3JhbShlKSB7XG4gICAgaWYgKGlzQmxvY2tseVZpc2libGUoKSkge1xuICAgICAgICBzYXZlQmxvY2tzKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBzYXZlQ29kZSgpO1xuICAgIH1cbiAgICAkKCcjc2F2ZURyb3Bkb3duTGluaycpLmRyb3Bkb3duKCd0b2dnbGUnKTtcbn1cblxuZnVuY3Rpb24gbG9hZEJsb2NrcygpIHtcbiAgICBjb25zdCBmaWxlU2VsZWN0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZEZpbGVuYW1lJyk7XG4gICAgY29uc3QgbG9hZEZpbGVuYW1lID0gZmlsZVNlbGVjdG9yLmZpbGVzWzBdO1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgIHJlYWRlci5yZWFkQXNUZXh0KGxvYWRGaWxlbmFtZSk7XG4gICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgICAgIGNvbnN0IHhtbCA9IEJsb2NrbHkuWG1sLnRleHRUb0RvbShyZWFkZXIucmVzdWx0KTtcbiAgICAgICAgQmxvY2tseS5YbWwuZG9tVG9Xb3Jrc3BhY2UoeG1sLCB3b3Jrc3BhY2UpO1xuICAgIH1cbiAgICAkKCcjbG9hZERyb3Bkb3duTGluaycpLmRyb3Bkb3duKCd0b2dnbGUnKTtcbn1cblxuZnVuY3Rpb24gbG9hZENvZGUoKSB7XG4gICAgY29uc3QgZmlsZVNlbGVjdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRGaWxlbmFtZScpO1xuICAgIGNvbnN0IGxvYWRGaWxlbmFtZSA9IGZpbGVTZWxlY3Rvci5maWxlc1swXTtcbiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZWFkZXIucmVhZEFzVGV4dChsb2FkRmlsZW5hbWUpO1xuICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihldikge1xuICAgICAgICBlZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFZhbHVlKHJlYWRlci5yZXN1bHQpO1xuICAgIH1cbiAgICAkKCcjbG9hZERyb3Bkb3duTGluaycpLmRyb3Bkb3duKCd0b2dnbGUnKTtcbn1cblxuZnVuY3Rpb24gbG9hZFByb2dyYW0oKSB7XG4gICAgaWYgKGlzQmxvY2tseVZpc2libGUoKSkge1xuICAgICAgICBsb2FkQmxvY2tzKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBsb2FkQ29kZSgpO1xuICAgIH1cbn1cblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3J1bkJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcnVuUHJvZ3JhbSwgZmFsc2UpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlYnVnQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWJ1Z1Byb2dyYW0sIGZhbHNlKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdG9wQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdG9wUHJvZ3JhbSwgZmFsc2UpO1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NhdmVCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVQcm9ncmFtLCBmYWxzZSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbG9hZFByb2dyYW0sIGZhbHNlKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYW1wbGVCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhbXBsZVByb2dyYW0sIGZhbHNlKTtcblxuLy8gSW5pdGlhbGl6ZSBBQ0UgSmF2YXNjcmlwdCBlZGl0b3JcbnZhciBlZGl0b3IgPSBhY2UuZWRpdChcImpzQ29kZVwiKTtcbmVkaXRvci5zZXRUaGVtZShcImFjZS90aGVtZS9tb25va2FpXCIpO1xuZWRpdG9yLnNlc3Npb24uc2V0TW9kZShcImFjZS9tb2RlL2phdmFzY3JpcHRcIik7XG5lZGl0b3Iuc2V0T3B0aW9ucyh7XG4gICAgLy8gZm9udEZhbWlseTogXCJ0YWhvbWFcIixcbiAgICBmb250U2l6ZTogXCIxMnB0XCJcbn0pO1xuXG4kKCdhW2RhdGEtdG9nZ2xlPVwidGFiXCJdJykub24oJ3Nob3duLmJzLnRhYicsIGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmlkID09PSAnY29kZS10YWInKSB7XG4gICAgICAgIGNvbnN0IGNvZGUgPSBnZW5lcmF0ZUNvZGUod29ya3NwYWNlLCBmYWxzZSk7XG4gICAgICAgIGVkaXRvci5nZXRTZXNzaW9uKCkuc2V0VmFsdWUoY29kZSk7XG5cbiAgICAgICAgdmFyIHhtbCA9IEJsb2NrbHkuWG1sLndvcmtzcGFjZVRvRG9tKHdvcmtzcGFjZSk7XG4gICAgICAgIHZhciB4bWxfdGV4dCA9IEJsb2NrbHkuWG1sLmRvbVRvVGV4dCh4bWwpO1xuICAgICAgICBjb25zb2xlLmxvZyh4bWxfdGV4dCk7XG4gICAgfVxufSlcblxuZnVuY3Rpb24gcmVzaXplKCkge1xuICAgIGNvbnNvbGUubG9nKFwicmVzaXplXCIpO1xuICAgIHZhciB3ID0gd2luZG93LmlubmVyV2lkdGggLSA4NTA7XG4gICAgdmFyIGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbWVcIikuY2xpZW50SGVpZ2h0O1xuICAgIHZhciBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YWJOYXZDb250ZW50XCIpO1xuICAgIGlmIChwLmNsaWVudFdpZHRoICE9IHcpIHtcbiAgICAgICAgcC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIndpZHRoOiBcIiArIHcgKyBcInB4OyBoZWlnaHQ6IFwiICsgaCArIFwicHg7XCIpO1xuICAgICAgICAvLyBUaGlzIGlzIGEgaGFjayB0byBmb3JjZSByZXNpemUgYWZ0ZXIgc2VsZWN0aW5nIGFub3RoZXJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB2YXIgZSA9IG5ldyBDdXN0b21FdmVudChcInJlc2l6ZVwiKTtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGUpO1xuICAgICAgICB9LCAxKTtcbiAgICB9XG59XG5cbnJlc2l6ZSgpO1xuXG53aW5kb3cub25yZXNpemUgPSByZXNpemU7XG4iXSwic291cmNlUm9vdCI6IiJ9